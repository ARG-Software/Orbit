
@if(member(); as m){
<div class="container mx-auto pb-8">
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center gap-4">
        <a routerLink="/app/team" class="btn btn-sm btn-square btn-ghost border border-base-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
        </a>
        <h1 class="text-2xl font-light tracking-tight">Member Profile</h1>
    </div>
    <div class="flex gap-2">
        <button class="btn btn-sm btn-ghost" (click)="openEmailModal()" title="Send Email">Email</button>
        <button class="btn btn-sm btn-ghost" (click)="deactivateMember()">
            {{ m.status === 'Active' ? 'Deactivate' : 'Activate' }}
        </button>
        <button class="btn btn-sm btn-ghost text-error" (click)="deleteMember()">Delete</button>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Left Sidebar: Profile Info -->
    <div class="lg:col-span-1 space-y-6">
        <div class="card bg-base-100 shadow-sm border border-base-200">
            <div class="card-body items-center text-center p-6">
                <div class="avatar mb-4">
                    <div class="w-24 rounded-full ring-1 ring-base-200 p-1">
                        <img [src]="m.avatarUrl" [alt]="m.name" class="object-cover rounded-full">
                    </div>
                </div>
                <h2 class="card-title text-xl font-bold">{{ m.name }}</h2>
                <p class="opacity-60 text-sm">{{ m.role }}</p>
                <div class="badge badge-sm mt-2 border-base-200" [class.badge-neutral]="m.status === 'Active'" [class.badge-ghost]="m.status !== 'Active'">{{ m.status }}</div>
                
                <div class="divider my-4 opacity-50"></div>
                
                <div class="w-full space-y-4 text-left">
                    <div class="form-control">
                        <label class="label py-0"><span class="label-text text-[10px] font-bold opacity-40 uppercase tracking-widest">Email</span></label>
                        <div class="font-medium text-sm break-all flex items-center gap-2 mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 opacity-40" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                            {{ m.email }}
                        </div>
                    </div>
                    <div class="form-control">
                        <label class="label py-0"><span class="label-text text-[10px] font-bold opacity-40 uppercase tracking-widest">Hourly Rate</span></label>
                        <div class="font-mono text-sm mt-1">${{ m.defaultHourlyRate }}/hr</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Form (Collapsible) -->
        <div class="collapse collapse-arrow bg-base-100 border border-base-200 shadow-sm rounded-lg">
            <input type="checkbox" /> 
            <div class="collapse-title font-bold text-xs uppercase opacity-50 tracking-wider py-4">
                Edit Profile
            </div>
            <div class="collapse-content">
                <div class="space-y-3 pt-2">
                    <div class="form-control">
                        <label class="label py-1 text-xs opacity-60">Name</label>
                        <input type="text" class="input input-bordered input-sm bg-base-100" [ngModel]="memberName()" (ngModelChange)="memberName.set($event)">
                    </div>
                    <div class="form-control">
                        <label class="label py-1 text-xs opacity-60">Role</label>
                        <input type="text" class="input input-bordered input